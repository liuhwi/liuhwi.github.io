<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Weihoop&#39;s Blog</title>
  <subtitle>My OPS Life</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://weihoop.com/"/>
  <updated>2017-01-25T14:50:08.000Z</updated>
  <id>http://weihoop.com/</id>
  
  <author>
    <name>weihoop</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MAC OS X 系统优化</title>
    <link href="http://weihoop.com/2014/02/22/optimize-macos-system/"/>
    <id>http://weihoop.com/2014/02/22/optimize-macos-system/</id>
    <published>2014-02-22T08:26:02.000Z</published>
    <updated>2017-01-25T14:50:08.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装brew"><a href="#安装brew" class="headerlink" title="安装brew"></a>安装brew</h2><p>Mac下打开Terminal, 复制并粘贴以下指令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby <span class="_">-e</span> <span class="string">"<span class="variable">$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)</span>"</span></div></pre></td></tr></table></figure></p>
<p>brew安装常用软件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install cmake git wget htop fping curl pigz mtr</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="安装Xcode"><a href="#安装Xcode" class="headerlink" title="安装Xcode"></a>安装Xcode</h2><ul>
<li>网上直接下载安装Xcode,也可以从App Store中下载安装,访问网址：<br><a href="https://developer.apple.com/downloads/index.action" target="_blank" rel="external">https://developer.apple.com/downloads/index.action</a></li>
<li>安装Xcode中的Command Line Tools:打开Xcode设置,在Downloads选项卡中点击Install”Command Line Tools”</li>
</ul>
<h2 id="配置终端-amp-设置alias"><a href="#配置终端-amp-设置alias" class="headerlink" title="配置终端&amp;设置alias"></a>配置终端&amp;设置alias</h2><p>设置 alias，可以在/etc/bashrc或者/etc/profile添加一下内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">cat &gt;&gt; /etc/profile &lt;&lt; EOF</div><div class="line"><span class="built_in">export</span> CLICOLOR=1</div><div class="line"><span class="built_in">export</span> GREP_OPTIONS=<span class="string">"--color=auto"</span></div><div class="line"><span class="comment">#PS1="\u@\h:\w $"</span></div><div class="line">PS1=<span class="string">"\e[32;1m\]\u@\h:\w $ \[\e[0m\]"</span></div><div class="line"></div><div class="line"><span class="built_in">alias</span> l.=<span class="string">'ls -d .*'</span></div><div class="line"><span class="built_in">alias</span> ll=<span class="string">'ls -l'</span></div><div class="line"><span class="built_in">alias</span> rm=<span class="string">'rm -i'</span></div><div class="line"><span class="built_in">alias</span> cp=<span class="string">'cp -i'</span></div><div class="line"><span class="built_in">alias</span> mv=<span class="string">'mv -i'</span></div><div class="line"><span class="built_in">alias</span> vi=<span class="string">'vim'</span></div><div class="line"><span class="built_in">alias</span> grep=<span class="string">'grep --color'</span></div><div class="line"><span class="built_in">alias</span> du1=<span class="string">'du -d 1 -h'</span></div><div class="line"><span class="built_in">alias</span> du2=<span class="string">'du -d 2 -h'</span></div><div class="line"><span class="built_in">alias</span> du3=<span class="string">'du -d 3 -h'</span></div><div class="line"><span class="built_in">alias</span> chosts=<span class="string">"cat /etc/hosts"</span></div><div class="line"><span class="built_in">alias</span> mhosts=<span class="string">"sudo vim /etc/hosts"</span></div><div class="line"></div><div class="line">HISTFILESIZE=5000</div><div class="line">HISTSIZE=5000</div><div class="line">HISTTIMEFORMAT=<span class="string">"%Y%m%d %T "</span></div><div class="line">EOF</div><div class="line"></div><div class="line"><span class="built_in">source</span> /etc/profile</div></pre></td></tr></table></figure>
<h2 id="安装pip"><a href="#安装pip" class="headerlink" title="安装pip"></a>安装pip</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo easy_install pip</div></pre></td></tr></table></figure>
<h2 id="安装sshpt"><a href="#安装sshpt" class="headerlink" title="安装sshpt"></a>安装sshpt</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">brew install gcc</div><div class="line">sudo easy_install pip</div><div class="line">sudo su -</div><div class="line">ARCHFLAGS=-Wno-error=unused-command-line-argument-hard-error-in-future pip install pycrypto</div><div class="line">wget http://sshpt.googlecode.com/files/sshpt-1.2.0.tar.gz</div><div class="line">tar zxvf sshpt-1.2.0.tar.gz</div><div class="line"><span class="built_in">cd</span> sshpt</div><div class="line">sudo python setup.py install</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;安装brew&quot;&gt;&lt;a href=&quot;#安装brew&quot; class=&quot;headerlink&quot; title=&quot;安装brew&quot;&gt;&lt;/a&gt;安装brew&lt;/h2&gt;&lt;p&gt;Mac下打开Terminal, 复制并粘贴以下指令：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ruby &lt;span class=&quot;_&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)&lt;/span&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;brew安装常用软件&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;brew install cmake git wget htop fping curl pigz mtr&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="macos" scheme="http://weihoop.com/tags/macos/"/>
    
  </entry>
  
  <entry>
    <title>Sublime快捷键</title>
    <link href="http://weihoop.com/2014/01/22/sublime%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <id>http://weihoop.com/2014/01/22/sublime快捷键/</id>
    <published>2014-01-22T08:26:02.000Z</published>
    <updated>2017-01-25T13:52:05.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h2><p>新建：cmd+n<br>打开：cmd+o<br>关闭：cmd+w<br>保存：cmd+s<br>另存为：cmd+shift+s</p>
<a id="more"></a>
<h2 id="功能类"><a href="#功能类" class="headerlink" title="功能类"></a>功能类</h2><ul>
<li>打开Command palatte：cmd+shift+p</li>
</ul>
<h2 id="Evernote"><a href="#Evernote" class="headerlink" title="Evernote"></a>Evernote</h2><ul>
<li>发送到evernote：ctrl+e、ctrl+s</li>
<li>打开evernote：ctrl+e、ctrl+o</li>
<li>保存到evernote：ctrl+e、ctrl+u</li>
</ul>
<h2 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h2><ul>
<li>新建md文件：ctrl+alt+m</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;基础功能&quot;&gt;&lt;a href=&quot;#基础功能&quot; class=&quot;headerlink&quot; title=&quot;基础功能&quot;&gt;&lt;/a&gt;基础功能&lt;/h2&gt;&lt;p&gt;新建：cmd+n&lt;br&gt;打开：cmd+o&lt;br&gt;关闭：cmd+w&lt;br&gt;保存：cmd+s&lt;br&gt;另存为：cmd+shift+s&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>cwRsync-Window服务器同步方案</title>
    <link href="http://weihoop.com/2010/02/26/cwrsync-window/"/>
    <id>http://weihoop.com/2010/02/26/cwrsync-window/</id>
    <published>2010-02-25T18:59:49.000Z</published>
    <updated>2017-01-25T20:01:22.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>适应场景：Windows服务器同步到Windows服务器上，Windows服务器同步到linux服务器上</p>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>下载地址：</p>
<p><a href="http://cdnetworks-kr-1.dl.sourceforge.net/project/sereds/cwRsync/4.1.0/cwRsyncServer_4.1.0_Installer.zip" target="_blank" rel="external">http://cdnetworks-kr-1.dl.sourceforge.net/project/sereds/cwRsync/4.1.0/cwRsyncServer_4.1.0_Installer.zip</a></p>
<p>将Server或者Client软件安装到服务器端和客户端服务器上，Server包含Client软件所以只安装Server软件即可。</p>
<a id="more"></a>
<h2 id="服务器端配置"><a href="#服务器端配置" class="headerlink" title="服务器端配置"></a>服务器端配置</h2><p>服务端IP: 10.0.101.174</p>
<h3 id="1-修改配置文件"><a href="#1-修改配置文件" class="headerlink" title="1. 修改配置文件"></a>1. 修改配置文件</h3><p>编写文件: C:\Program Files\ICW\rsyncd.conf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">uid = 0</div><div class="line">gid = 0</div><div class="line">use chroot = false</div><div class="line">strict modes = false</div><div class="line">read only = yes</div><div class="line">list = no</div><div class="line">hosts allow = *</div><div class="line">max connections = 3</div><div class="line">secrets file = rsyncd.secrets     #指定用户登录的密码文件</div><div class="line">motd file = rsyncd.motd           #连接上rsync server时显示的欢迎信息</div><div class="line">log file = rsyncd.log</div><div class="line">pid file = rsyncd.pid</div><div class="line">transfer logging = yes</div><div class="line"># Module definitions</div><div class="line"># Remember cygwin naming conventions : c:/work becomes /cygwin/c/work</div><div class="line"></div><div class="line">[test]</div><div class="line">path = /cygdrive/c/work</div><div class="line">read only = false</div><div class="line">transfer logging = yes</div><div class="line"></div><div class="line">[cwrsync]</div><div class="line">path = /cygdrive/d/rsyncfile</div><div class="line">read only = false</div><div class="line">auth users = test</div><div class="line">secrets file= /cygdrive/c/Program Files/icw/rsyncd.passwd</div><div class="line">transfer logging = yes</div></pre></td></tr></table></figure>
<h3 id="2-建立密码文件"><a href="#2-建立密码文件" class="headerlink" title="2. 建立密码文件"></a>2. 建立密码文件</h3><p>在C:\Program Files\ICW目录下新建密码文件 rsyncd.passwd 内容为用户名密码，如: test:test</p>
<h2 id="客户端使用"><a href="#客户端使用" class="headerlink" title="客户端使用"></a>客户端使用</h2><h3 id="1-Windows客户端"><a href="#1-Windows客户端" class="headerlink" title="1. Windows客户端"></a>1. Windows客户端</h3><p>在cmd命令下执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;C:\Program Files\icw\bin\chmod.exe” 600 “/cygdrive/C/Program Files/icw/rsyncd.passwd&quot;</div></pre></td></tr></table></figure>
<p>CMD 下输入下面命令即可同步服务器端cwrsync模块到客户端d:/rsyncfile目录下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">“C:\Program Files\ICW/bin/rsync.exe” -vzrtopg –progress –password-file=”/cygdrive/C/Program Files/icw/rsyncd.passwd” test@10.0.101.174::cwrsync /cygdrive/d/rsyncfile</div><div class="line">“C:\Program Files\icw\bin\rsync” -vzrtopg –progress –password-file=”/cygdrive/C/Program Files/icw/rsync.passwd” test@10.0.101.174::cwrsync /cygdrive/d/rsyncfile</div></pre></td></tr></table></figure>
<p>如果没有同步，可以使用下面方法排除故障</p>
<ul>
<li>检查服务器是否有开服务端口，命令行输入( netstat -a ) 可查看服务器开的端口。就是上面的36536端口。</li>
<li>客户端命令行输入( telnet 服务端ip 服务端口 ) 能否连接服务器端。3.检查配置文件是否跟上面一样。</li>
</ul>
<h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h4><p>以上为匿名连接入服务器端，一般会在模块里添加 auth user= administrator 指定用户，一定要注意，指定的用户必须要登陆才能进行同步服务。</p>
<h3 id="2-linux客户端"><a href="#2-linux客户端" class="headerlink" title="2. linux客户端"></a>2. linux客户端</h3><p>输入下面命令进行同步</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync -vzrtopg –password-file=/etc/cwrsync.pass –progress cwsync@10.0.101.174::test  /rsyncfile</div></pre></td></tr></table></figure>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="错误1"><a href="#错误1" class="headerlink" title="错误1"></a>错误1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync: read error: Connection reset by peer (104) rsync error: error in rsync protocol data stream (code 12) at io.c(794) [receiver=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：很大可能是服务器端没有开启 rsync 服务。开启服务。</p>
<h3 id="错误2"><a href="#错误2" class="headerlink" title="错误2"></a>错误2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@ERROR: chdir failed rsync error: error starting client-server protocol (code 5) at main.c(1495) [receiver=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。</p>
<h3 id="错误3"><a href="#错误3" class="headerlink" title="错误3"></a>错误3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@ERROR: failed to open lock file rsync error: error starting client-server protocol (code 5) at main.c(1495) [receiver=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：配置文件 rsync.conf中添加 lock file = rsyncd.lock 即可解决。 </p>
<h3 id="错误4"><a href="#错误4" class="headerlink" title="错误4"></a>错误4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@ERROR: invalid uid nobody</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]</div></pre></td></tr></table></figure>
<p>解决：在rsyncd.conf文件中添加下面两行即可解决问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">uid = 0</div><div class="line">gid = 0</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;适应场景：Windows服务器同步到Windows服务器上，Windows服务器同步到linux服务器上&lt;/p&gt;
&lt;h2 id=&quot;下载&quot;&gt;&lt;a href=&quot;#下载&quot; class=&quot;headerlink&quot; title=&quot;下载&quot;&gt;&lt;/a&gt;下载&lt;/h2&gt;&lt;p&gt;下载地址：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://cdnetworks-kr-1.dl.sourceforge.net/project/sereds/cwRsync/4.1.0/cwRsyncServer_4.1.0_Installer.zip&quot;&gt;http://cdnetworks-kr-1.dl.sourceforge.net/project/sereds/cwRsync/4.1.0/cwRsyncServer_4.1.0_Installer.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;将Server或者Client软件安装到服务器端和客户端服务器上，Server包含Client软件所以只安装Server软件即可。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Windows" scheme="http://weihoop.com/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Rsync问题排查</title>
    <link href="http://weihoop.com/2010/01/26/rsync-error/"/>
    <id>http://weihoop.com/2010/01/26/rsync-error/</id>
    <published>2010-01-26T04:50:47.000Z</published>
    <updated>2017-01-25T20:01:57.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="错误1"><a href="#错误1" class="headerlink" title="错误1"></a>错误1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">rsync: <span class="built_in">read</span> error: Connection reset by peer (104)</div><div class="line">rsync error: error <span class="keyword">in</span> rsync protocol data stream (code 12) at io.c(794) [receive</div><div class="line">r=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：很大可能是服务器端没有开启 rsync 服务。开启服务。</p>
<h3 id="错误2"><a href="#错误2" class="headerlink" title="错误2"></a>错误2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@ERROR: chdir failed</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1495) [rec</div><div class="line">eiver=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。</p>
<a id="more"></a>
<h3 id="错误3"><a href="#错误3" class="headerlink" title="错误3"></a>错误3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">@ERROR: failed to open lock file</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1495) [rec</div><div class="line">eiver=3.0.2]</div></pre></td></tr></table></figure>
<p>解决：配置文件 rsync.conf中添加 lock file = rsyncd.lock 即可解决</p>
<h3 id="错误4"><a href="#错误4" class="headerlink" title="错误4"></a>错误4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">rsync: could not open password file “/etc/rsync.pas”: No such file or directory (2)</div><div class="line">Password:</div><div class="line">@ERROR: auth failed on module backup</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]</div></pre></td></tr></table></figure>
<p>解决：client端没有设置/etc/rsync.pas这个文件，而在使用rsync命令的时候，加了这个参数–password-file=/etc/rsync.pas</p>
<h3 id="错误5"><a href="#错误5" class="headerlink" title="错误5"></a>错误5</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@ERROR: auth failed on module backup</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]</div></pre></td></tr></table></figure>
<p>解决：client端已经设置/etc/rsync.pas这个文件，里面也设置了密码111111，和服务器一致，但是服务器段设置有错误，服务器端应该设置/etc/rsync.pas  ，里面内容root:111111 ,这里登陆名不可缺少</p>
<h3 id="错误6"><a href="#错误6" class="headerlink" title="错误6"></a>错误6</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@ERROR: chdir failed</div><div class="line">rsync error: error starting client-server protocol (code 5) at main.c(1506) [Receiver=3.0.7]</div></pre></td></tr></table></figure>
<p>解决：服务器端的/data/backup  其中backup这个目录并没有设置，所以提示：chdir failed</p>
<h3 id="错误7"><a href="#错误7" class="headerlink" title="错误7"></a>错误7</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync: write failed on “/data/backup”: No space left on device (28)</div><div class="line">rsync error: error in file IO (code 11) at receiver.c(302) [receiver=3.0.7]</div></pre></td></tr></table></figure>
<p>解决：磁盘空间不够，所以无法操作。</p>
<h3 id="错误8"><a href="#错误8" class="headerlink" title="错误8"></a>错误8</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rsync: opendir “/kexue” (in dtsChannel) failed: Permission denied (13)</div></pre></td></tr></table></figure>
<p>解决：注意查看同步的目录权限是否为755</p>
<h3 id="错误9"><a href="#错误9" class="headerlink" title="错误9"></a>错误9</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync: failed to connect to 203.100.192.66: Connection timed out (110)</div><div class="line">rsync error: error in socket IO (code 10) at clientserver.c(124) [receiver=3.0.5]</div></pre></td></tr></table></figure>
<p>解决：连接时间超时，检查服务器的端口netstat –tunlp，远程telnet测试。</p>
<h3 id="错误10"><a href="#错误10" class="headerlink" title="错误10"></a>错误10</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync: failed to connect to 10.10.10.170: Connection refused (111)</div><div class="line">rsync error: error in socket IO (code 10) at clientserver.c(124) [receiver=3.0.5]</div></pre></td></tr></table></figure>
<p>解决：rsync服务未启动，启动rsync服务：rsync –daemon –config=/etc/rsyncd.conf</p>
<h3 id="错误11"><a href="#错误11" class="headerlink" title="错误11"></a>错误11</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync error: received SIGINT, SIGTERM, or SIGHUP (code 20) at rsync.c(544) [receiver=3.0.5]</div><div class="line">rsync error: received SIGINT, SIGTERM, or SIGHUP (code 20) at rsync.c(544) [generator=3.0.5]</div></pre></td></tr></table></figure>
<p>解决：Ctrl+C或者大量文件</p>
<h3 id="错误12"><a href="#错误12" class="headerlink" title="错误12"></a>错误12</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rsync: read error: Connection reset by peer (104)</div><div class="line">rsync error: error in rsync protocol data stream (code 12) at io.c(759) [receiver=3.0.5]</div></pre></td></tr></table></figure>
<p>解决：查看rsync日志<br>rsync: unable to open configuration file “/etc/rsyncd.conf”: No such file or directory<br>xnetid查找的配置文件位置默认是/etc下，根据具体情况创建软链接。例如：<br>ln -s /etc/rsyncd/rsyncd.conf /etc/rsyncd.conf<br>或者更改指定默认的配置文件路径，在/etc/xinetd.d/rsync配置文件中.</p>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;错误1&quot;&gt;&lt;a href=&quot;#错误1&quot; class=&quot;headerlink&quot; title=&quot;错误1&quot;&gt;&lt;/a&gt;错误1&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;rsync: &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; error: Connection reset by peer (104)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rsync error: error &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; rsync protocol data stream (code 12) at io.c(794) [receive&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r=3.0.2]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决：很大可能是服务器端没有开启 rsync 服务。开启服务。&lt;/p&gt;
&lt;h3 id=&quot;错误2&quot;&gt;&lt;a href=&quot;#错误2&quot; class=&quot;headerlink&quot; title=&quot;错误2&quot;&gt;&lt;/a&gt;错误2&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;@ERROR: chdir failed&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;rsync error: error starting client-server protocol (code 5) at main.c(1495) [rec&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;eiver=3.0.2]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决：服务器端同步目录没有权限，cwrsync默认用户是Svcwrsync。为同步目录添加用户Svcwrsync权限。&lt;/p&gt;
    
    </summary>
    
    
      <category term="linux" scheme="http://weihoop.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>MySQL常用命令</title>
    <link href="http://weihoop.com/2009/11/02/mysql-cmd/"/>
    <id>http://weihoop.com/2009/11/02/mysql-cmd/</id>
    <published>2009-11-02T04:31:02.000Z</published>
    <updated>2017-01-25T20:01:43.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h2><h4 id="1-登录使用默认3306端口的MySQL"><a href="#1-登录使用默认3306端口的MySQL" class="headerlink" title="1. 登录使用默认3306端口的MySQL"></a>1. 登录使用默认3306端口的MySQL</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p</div></pre></td></tr></table></figure>
<h4 id="2-通过TCP连接管理不同端口的多个MySQL（注意：MySQL4-1以上版本才有此项功能）"><a href="#2-通过TCP连接管理不同端口的多个MySQL（注意：MySQL4-1以上版本才有此项功能）" class="headerlink" title="2. 通过TCP连接管理不同端口的多个MySQL（注意：MySQL4.1以上版本才有此项功能）"></a>2. 通过TCP连接管理不同端口的多个MySQL（注意：MySQL4.1以上版本才有此项功能）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p –protocol=tcp –host=localhost –port=3307</div></pre></td></tr></table></figure>
<h4 id="3-通过socket套接字管理不同端口的多个MySQL"><a href="#3-通过socket套接字管理不同端口的多个MySQL" class="headerlink" title="3. 通过socket套接字管理不同端口的多个MySQL"></a>3. 通过socket套接字管理不同端口的多个MySQL</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p –socket=/tmp/mysql3307.sock</div></pre></td></tr></table></figure>
<h4 id="4-通过端口和IP管理不同端口的多个MySQL"><a href="#4-通过端口和IP管理不同端口的多个MySQL" class="headerlink" title="4. 通过端口和IP管理不同端口的多个MySQL"></a>4. 通过端口和IP管理不同端口的多个MySQL</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p -P 3306 -h 127.0.0.1</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="数据库操作SQL语句"><a href="#数据库操作SQL语句" class="headerlink" title="数据库操作SQL语句"></a>数据库操作SQL语句</h2><h4 id="1-显示Mysql所有数据库"><a href="#1-显示Mysql所有数据库" class="headerlink" title="1. 显示Mysql所有数据库"></a>1. 显示Mysql所有数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SHOW DATABASES;</div></pre></td></tr></table></figure>
<h4 id="2-创建名称为test的数据库"><a href="#2-创建名称为test的数据库" class="headerlink" title="2. 创建名称为test的数据库"></a>2. 创建名称为test的数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; CREATE DATABASE test;</div></pre></td></tr></table></figure>
<h4 id="3-删除名称为test的数据库"><a href="#3-删除名称为test的数据库" class="headerlink" title="3. 删除名称为test的数据库"></a>3. 删除名称为test的数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DROP DATABASE test;</div></pre></td></tr></table></figure>
<h4 id="4-选择test数据库"><a href="#4-选择test数据库" class="headerlink" title="4. 选择test数据库"></a>4. 选择test数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; USE test;</div></pre></td></tr></table></figure>
<h2 id="表操作SQL语句"><a href="#表操作SQL语句" class="headerlink" title="表操作SQL语句"></a>表操作SQL语句</h2><h4 id="1-显示当前数据库中存在什么表"><a href="#1-显示当前数据库中存在什么表" class="headerlink" title="1. 显示当前数据库中存在什么表"></a>1. 显示当前数据库中存在什么表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SHOW TABLES;</div></pre></td></tr></table></figure>
<h4 id="2-创建数据库表user：在mysql-gt-后粘贴以下SQL语句，存储引擎为MYISAM，字段id为主键、唯一索引。"><a href="#2-创建数据库表user：在mysql-gt-后粘贴以下SQL语句，存储引擎为MYISAM，字段id为主键、唯一索引。" class="headerlink" title="2. 创建数据库表user：在mysql&gt;后粘贴以下SQL语句，存储引擎为MYISAM，字段id为主键、唯一索引。"></a>2. 创建数据库表user：在mysql&gt;后粘贴以下SQL语句，存储引擎为MYISAM，字段id为主键、唯一索引。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">mysql &gt; CREATE TABLE `spitfire` (</div><div class="line">`id` INT( 5 ) UNSIGNED NOT NULL AUTO_INCREMENT,</div><div class="line">`username` VARCHAR( 20 ) NOT NULL,</div><div class="line">`password` CHAR( 32 ) NOT NULL,</div><div class="line">`time` DATETIME NOT NULL,</div><div class="line">`number` FLOAT( 10 ) NOT NULL,</div><div class="line">`content` TEXT NOT NULL,</div><div class="line">PRIMARY KEY (`id`)</div><div class="line">) ENGINE = INNODB ;</div><div class="line"></div><div class="line">INSERT INTO `spitfire` (`id`, `username`, `password`, `time`, `number`) VALUES (&apos;1′, &apos;lhw&apos;, &apos;123456′, &apos;2011-1-1′, 8888);</div></pre></td></tr></table></figure>
<h4 id="3-查看user表结构"><a href="#3-查看user表结构" class="headerlink" title="3. 查看user表结构"></a>3. 查看user表结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DESCRIBE user;</div></pre></td></tr></table></figure>
<h2 id="从表中检索信息"><a href="#从表中检索信息" class="headerlink" title="从表中检索信息"></a>从表中检索信息</h2><h4 id="1-从user表中检索所有记录"><a href="#1-从user表中检索所有记录" class="headerlink" title="1. 从user表中检索所有记录"></a>1. 从user表中检索所有记录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SELECT * FROM user;</div></pre></td></tr></table></figure>
<h4 id="2-从user表中检索特定的行"><a href="#2-从user表中检索特定的行" class="headerlink" title="2. 从user表中检索特定的行"></a>2. 从user表中检索特定的行</h4><p>字段username等于abc，字段number等于1，按字段id降序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SELECT * FROM user WHERE username = &apos;abc&apos; AND number=&apos;1′ ORDER BY id DESC;</div></pre></td></tr></table></figure>
<h4 id="3-从user表中检索指定的字段"><a href="#3-从user表中检索指定的字段" class="headerlink" title="3. 从user表中检索指定的字段"></a>3. 从user表中检索指定的字段</h4><p>指定username和password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SELECT username, password FROM zhangyan;</div></pre></td></tr></table></figure>
<h4 id="4-从user表中检索出唯一的不重复记录"><a href="#4-从user表中检索出唯一的不重复记录" class="headerlink" title="4. 从user表中检索出唯一的不重复记录"></a>4. 从user表中检索出唯一的不重复记录</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SELECT DISTINCT username FROM user;</div></pre></td></tr></table></figure>
<h4 id="5-插入信息到user表"><a href="#5-插入信息到user表" class="headerlink" title="5. 插入信息到user表"></a>5. 插入信息到user表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt;</div></pre></td></tr></table></figure>
<h4 id="6-更新user表中的指定信息"><a href="#6-更新user表中的指定信息" class="headerlink" title="6. 更新user表中的指定信息"></a>6. 更新user表中的指定信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; UPDATE user SET content = &apos;hello china&apos; WHERE username = &apos;abc&apos;;</div></pre></td></tr></table></figure>
<h4 id="7-删除user表中的指定信息"><a href="#7-删除user表中的指定信息" class="headerlink" title="7. 删除user表中的指定信息"></a>7. 删除user表中的指定信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DELETE FROM user WHERE id = 1;</div></pre></td></tr></table></figure>
<h4 id="8-清空user表"><a href="#8-清空user表" class="headerlink" title="8. 清空user表"></a>8. 清空user表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DELETE FROM user;</div></pre></td></tr></table></figure>
<h4 id="9-快速清空表"><a href="#9-快速清空表" class="headerlink" title="9. 快速清空表"></a>9. 快速清空表</h4><p>利用SQL语句清空了该数据表，而不保留日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; TRUNCATE TABLE TableName;</div></pre></td></tr></table></figure>
<h4 id="10-删除user表"><a href="#10-删除user表" class="headerlink" title="10.删除user表"></a>10.删除user表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DROP TABLE user;</div></pre></td></tr></table></figure>
<h4 id="11-更改表结构"><a href="#11-更改表结构" class="headerlink" title="11.更改表结构"></a>11.更改表结构</h4><p>将user表username字段的字段类型改为CHAR(25)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; ALTER TABLE user CHANGE username username CHAR(25);</div></pre></td></tr></table></figure>
<h4 id="12-将当前目录下的mysql-sql导入数据库"><a href="#12-将当前目录下的mysql-sql导入数据库" class="headerlink" title="12.将当前目录下的mysql.sql导入数据库"></a>12.将当前目录下的mysql.sql导入数据库</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SOURCE ./mysql.sql;</div></pre></td></tr></table></figure>
<h2 id="表引擎"><a href="#表引擎" class="headerlink" title="表引擎"></a>表引擎</h2><h4 id="1-查看引擎"><a href="#1-查看引擎" class="headerlink" title="1. 查看引擎"></a>1. 查看引擎</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mysql &gt; show table status like &apos;TableName&apos;\G;</div><div class="line">mysql &gt; show table status from tablename; # 这条最直接</div><div class="line">mysql &gt; show create table tablename;</div><div class="line">mysql -uroot -p -e “show table status” -D DBname|sed &apos;1d&apos; | awk &apos;&#123;print $1″ “$2&#125;&apos;</div><div class="line">mysql -uroot -p123456 -e “show table status from dc\G;”  | grep -ie “Name” -ie “Engine”</div></pre></td></tr></table></figure>
<h4 id="2-转换引擎："><a href="#2-转换引擎：" class="headerlink" title="2. 转换引擎："></a>2. 转换引擎：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; ALTER TABLE `table_name` ENGINE=MyISAM;</div></pre></td></tr></table></figure>
<h2 id="表索引"><a href="#表索引" class="headerlink" title="表索引"></a>表索引</h2><h4 id="1-普通索引"><a href="#1-普通索引" class="headerlink" title="1. 普通索引"></a>1. 普通索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; ALTER TABLE `DBname`.`TableName` ADD INDEX `user_add_date` (`user_add_date`);</div></pre></td></tr></table></figure>
<h4 id="2、聚合索引"><a href="#2、聚合索引" class="headerlink" title="2、聚合索引"></a>2、聚合索引</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; ALTER TABLE `DBname`.`TableName` ADD INDEX `user_channel` (`user_channel`, `user_from_site`);</div></pre></td></tr></table></figure>
<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><h4 id="1-查看触发器语句"><a href="#1-查看触发器语句" class="headerlink" title="1. 查看触发器语句"></a>1. 查看触发器语句</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; show CREATE TRIGGER tablesname\G;</div></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; use dbname</div><div class="line">mysql&gt; SHOW TRIGGERS;</div></pre></td></tr></table></figure>
<h4 id="2-查看表的触发器"><a href="#2-查看表的触发器" class="headerlink" title="2. 查看表的触发器"></a>2. 查看表的触发器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SHOW TRIGGERS FROM tablename\G;</div></pre></td></tr></table></figure>
<h2 id="mysql用户管理"><a href="#mysql用户管理" class="headerlink" title="mysql用户管理"></a>mysql用户管理</h2><h4 id="1-mysql修改密码"><a href="#1-mysql修改密码" class="headerlink" title="1. mysql修改密码"></a>1. mysql修改密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqladmin -uroot -p”oldpwd” password “newpwd”</div></pre></td></tr></table></figure>
<h4 id="2-使用下面语句生成加密密码，之后修改密码为加密后的密码"><a href="#2-使用下面语句生成加密密码，之后修改密码为加密后的密码" class="headerlink" title="2. 使用下面语句生成加密密码，之后修改密码为加密后的密码"></a>2. 使用下面语句生成加密密码，之后修改密码为加密后的密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SELECT PASSWORD(&apos;PAWD&apos;);</div><div class="line">mysql&gt; SET PASSWORD FOR spitfire@”%” = PAWD；</div></pre></td></tr></table></figure>
<h4 id="3-使用update语句-密码同样为加密后的密码"><a href="#3-使用update语句-密码同样为加密后的密码" class="headerlink" title="3. 使用update语句,密码同样为加密后的密码"></a>3. 使用update语句,密码同样为加密后的密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; UPDATE USER SET password=”newpwd” WHERE user=root and host=localhost;</div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure>
<h2 id="权限操作SQL语句"><a href="#权限操作SQL语句" class="headerlink" title="权限操作SQL语句"></a>权限操作SQL语句</h2><h4 id="1-查看用户信息"><a href="#1-查看用户信息" class="headerlink" title="1. 查看用户信息"></a>1. 查看用户信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p -e “use mysql;select user,host from user”</div></pre></td></tr></table></figure>
<h4 id="2-创建一个具有root权限，可从任何IP登录的用户leon，密码为123456"><a href="#2-创建一个具有root权限，可从任何IP登录的用户leon，密码为123456" class="headerlink" title="2. 创建一个具有root权限，可从任何IP登录的用户leon，密码为123456"></a>2. 创建一个具有root权限，可从任何IP登录的用户leon，密码为123456</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; GRANT ALL PRIVILEGES ON *.* TO &apos;leon&apos;@&apos;%&apos; IDENTIFIED BY &apos;123456′;</div></pre></td></tr></table></figure>
<h4 id="3-创建一个具有“数据操作”、“结构操作”权限，只能从192-168-1-登录的用户leon，密码为123456"><a href="#3-创建一个具有“数据操作”、“结构操作”权限，只能从192-168-1-登录的用户leon，密码为123456" class="headerlink" title="3. 创建一个具有“数据操作”、“结构操作”权限，只能从192.168.1.*登录的用户leon，密码为123456"></a>3. 创建一个具有“数据操作”、“结构操作”权限，只能从192.168.1.<em>*</em>登录的用户leon，密码为123456</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; GRANT SELECT , INSERT , UPDATE , DELETE , FILE , CREATE , DROP , INDEX , ALTER , CREATE TEMPORARY TABLES , CREATE VIEW , SHOW VIEW , CREATE ROUTINE, ALTER ROUTINE, EXECUTE ON *.* TO &apos;leon&apos;@&apos;192.168.1.%&apos; IDENTIFIED BY &apos;123456′;</div></pre></td></tr></table></figure>
<h4 id="4-创建一个只拥有“数据操作”权限，只能从192-168-1-24登录，只能操作test数据库的user表的用户leon，密码为123456"><a href="#4-创建一个只拥有“数据操作”权限，只能从192-168-1-24登录，只能操作test数据库的user表的用户leon，密码为123456" class="headerlink" title="4. 创建一个只拥有“数据操作”权限，只能从192.168.1.24登录，只能操作test数据库的user表的用户leon，密码为123456"></a>4. 创建一个只拥有“数据操作”权限，只能从192.168.1.24登录，只能操作test数据库的user表的用户leon，密码为123456</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; GRANT SELECT , INSERT , UPDATE , DELETE ON  test.user TO &apos;leon&apos;@&apos;192.168.1.24′ IDENTIFIED BY &apos;123456′;</div></pre></td></tr></table></figure>
<h4 id="5-创建一个拥有“数据操作”、“结构操作”权限，可从任何IP登录，只能操作test数据库的用户leon，密码为123456"><a href="#5-创建一个拥有“数据操作”、“结构操作”权限，可从任何IP登录，只能操作test数据库的用户leon，密码为123456" class="headerlink" title="5. 创建一个拥有“数据操作”、“结构操作”权限，可从任何IP登录，只能操作test数据库的用户leon，密码为123456"></a>5. 创建一个拥有“数据操作”、“结构操作”权限，可从任何IP登录，只能操作test数据库的用户leon，密码为123456</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; GRANT SELECT , INSERT , UPDATE , DELETE , CREATE , DROP , INDEX , ALTER , CREATE TEMPORARY TABLES , CREATE VIEW , SHOW VIEW , CREATE ROUTINE, ALTER ROUTINE, EXECUTE ON test.* TO &apos;leon&apos;@&apos;%&apos; IDENTIFIED BY &apos;123456′;</div></pre></td></tr></table></figure>
<h4 id="6-创建一个拥有“数据查询”权限，可以从192-168-0-10登陆，只能查询table1和table2表的用户query，密码是zbcx-123456"><a href="#6-创建一个拥有“数据查询”权限，可以从192-168-0-10登陆，只能查询table1和table2表的用户query，密码是zbcx-123456" class="headerlink" title="6. 创建一个拥有“数据查询”权限，可以从192.168.0.10登陆，只能查询table1和table2表的用户query，密码是zbcx*123456"></a>6. 创建一个拥有“数据查询”权限，可以从192.168.0.10登陆，只能查询table1和table2表的用户query，密码是zbcx*123456</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql &gt; GRANT SELECT  ON table1.* TO &apos;query&apos;@&apos;192.168.0.10′ IDENTIFIED BY &apos;zbcx*123456#&apos;;</div><div class="line">mysql &gt; GRANT SELECT  ON table1.* TO &apos;query&apos;@&apos;192.168.0.10′ IDENTIFIED BY &apos;zbcx*123456#&apos;;</div></pre></td></tr></table></figure>
<h4 id="7-删除用户"><a href="#7-删除用户" class="headerlink" title="7. 删除用户"></a>7. 删除用户</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; DROP USER &apos;spitfire&apos;@&apos;%&apos;;</div></pre></td></tr></table></figure>
<h4 id="8-去除用户权限"><a href="#8-去除用户权限" class="headerlink" title="8. 去除用户权限"></a>8. 去除用户权限</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql &gt; REVOKE ALL PRIVILEGES ON *.* from &apos;query&apos;@&apos;192.168.0.%&apos;;</div><div class="line">mysql &gt; REVOKE GRANT OPTION  ON *.* from &apos;query&apos;@&apos;192.168.1.%&apos;;</div></pre></td></tr></table></figure>
<h4 id="9-查看用户权限"><a href="#9-查看用户权限" class="headerlink" title="9. 查看用户权限"></a>9. 查看用户权限</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; show grants for root@&apos;localhost&apos;;</div></pre></td></tr></table></figure>
<h2 id="MySQL备份"><a href="#MySQL备份" class="headerlink" title="MySQL备份"></a>MySQL备份</h2><h4 id="1-混合引擎"><a href="#1-混合引擎" class="headerlink" title="1. 混合引擎"></a>1. 混合引擎</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysqldump -uroot -p –default-character-set=utf8 –opt –lock-all-tables db_name &gt; db_name.sql</div></pre></td></tr></table></figure>
<h4 id="2-导出全库到一个文件"><a href="#2-导出全库到一个文件" class="headerlink" title="2. 导出全库到一个文件"></a>2. 导出全库到一个文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysqldump -uroot -p –default-character-set=utf8 –lock-all-tables –flush-logs –all-databases  &gt; x.sql</div><div class="line">mysqldump -uroot -p –default-character-set=utf8 –hex-blob –routines –lock-all-tables database &gt; /tmp/database.sql</div></pre></td></tr></table></figure>
<h2 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h2><h4 id="1-查看从库命令："><a href="#1-查看从库命令：" class="headerlink" title="1. 查看从库命令："></a>1. 查看从库命令：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -p -e “select HOST from information_schema.PROCESSLIST where STATE like &apos;%slave%&apos;;”</div></pre></td></tr></table></figure>
<h4 id="2-校验主从表"><a href="#2-校验主从表" class="headerlink" title="2. 校验主从表"></a>2. 校验主从表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mk-table-checksum h=192.168.0.1,u=root,p=xxx h=192.168.0.2,u=root,p=xxx -d test -t test</div></pre></td></tr></table></figure>
<p>或者同时进入2个库，同时执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt;select conunt(*) from test;</div><div class="line">mysql&gt;checksum table table_name;</div></pre></td></tr></table></figure>
<h2 id="查看mysql版本"><a href="#查看mysql版本" class="headerlink" title="查看mysql版本"></a>查看mysql版本</h2><h4 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -V</div></pre></td></tr></table></figure>
<h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; status;</div></pre></td></tr></table></figure>
<h4 id="方法3"><a href="#方法3" class="headerlink" title="方法3"></a>方法3</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql –help | grep Distrib</div></pre></td></tr></table></figure>
<h4 id="方法4"><a href="#方法4" class="headerlink" title="方法4"></a>方法4</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; select version();</div></pre></td></tr></table></figure>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h4 id="1-查看mysql编译参数"><a href="#1-查看mysql编译参数" class="headerlink" title="1. 查看mysql编译参数"></a>1. 查看mysql编译参数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat /usr/local/mysql/bin/mysqlbug |grep ./configure</div></pre></td></tr></table></figure>
<h4 id="2-查看mysql默认编码"><a href="#2-查看mysql默认编码" class="headerlink" title="2. 查看mysql默认编码"></a>2. 查看mysql默认编码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql &gt; SHOW VARIABLES LIKE &apos;character_set_%&apos;;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;登录&quot;&gt;&lt;a href=&quot;#登录&quot; class=&quot;headerlink&quot; title=&quot;登录&quot;&gt;&lt;/a&gt;登录&lt;/h2&gt;&lt;h4 id=&quot;1-登录使用默认3306端口的MySQL&quot;&gt;&lt;a href=&quot;#1-登录使用默认3306端口的MySQL&quot; class=&quot;headerlink&quot; title=&quot;1. 登录使用默认3306端口的MySQL&quot;&gt;&lt;/a&gt;1. 登录使用默认3306端口的MySQL&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql -u root -p&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;2-通过TCP连接管理不同端口的多个MySQL（注意：MySQL4-1以上版本才有此项功能）&quot;&gt;&lt;a href=&quot;#2-通过TCP连接管理不同端口的多个MySQL（注意：MySQL4-1以上版本才有此项功能）&quot; class=&quot;headerlink&quot; title=&quot;2. 通过TCP连接管理不同端口的多个MySQL（注意：MySQL4.1以上版本才有此项功能）&quot;&gt;&lt;/a&gt;2. 通过TCP连接管理不同端口的多个MySQL（注意：MySQL4.1以上版本才有此项功能）&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql -u root -p –protocol=tcp –host=localhost –port=3307&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;3-通过socket套接字管理不同端口的多个MySQL&quot;&gt;&lt;a href=&quot;#3-通过socket套接字管理不同端口的多个MySQL&quot; class=&quot;headerlink&quot; title=&quot;3. 通过socket套接字管理不同端口的多个MySQL&quot;&gt;&lt;/a&gt;3. 通过socket套接字管理不同端口的多个MySQL&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql -u root -p –socket=/tmp/mysql3307.sock&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;4-通过端口和IP管理不同端口的多个MySQL&quot;&gt;&lt;a href=&quot;#4-通过端口和IP管理不同端口的多个MySQL&quot; class=&quot;headerlink&quot; title=&quot;4. 通过端口和IP管理不同端口的多个MySQL&quot;&gt;&lt;/a&gt;4. 通过端口和IP管理不同端口的多个MySQL&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;mysql -u root -p -P 3306 -h 127.0.0.1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="mysql" scheme="http://weihoop.com/tags/mysql/"/>
    
  </entry>
  
</feed>
